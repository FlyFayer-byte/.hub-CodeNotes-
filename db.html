<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–æ–≤—ñ–¥–Ω–∏–∫ HTML & CSS</title>
    <link rel="stylesheet" href="styles.css">
    <style>
/* –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ */
.modal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.8);
    background: rgba(0, 0, 0, 0.9);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 255, 212, 0.8);
    z-index: 1000;
    opacity: 0;
    transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
    width: 90%;
    max-width: 400px;
}

.modal.show {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
    display: block;
}

.modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
}

.modal-overlay.show {
    opacity: 1;
    display: block;
}

.textarea {
  display: block;
  width: 100%;
  resize: none;
  background-color: inherit;
  color: inherit;
  border: none;
  padding: 0;
  margin: 0;
}
    </style>
  </head>
  <body>
    <header>
      <div id="logo">.hub{CodeNotes}</div>
      <nav>
        <ul>
          <li><a href="index.html">–ì–æ–ª–æ–≤–Ω–∞</a></li>
          <li><a href="html.html">HTML</a></li>
          <li><a href="css.html">CSS</a></li>
          <li><a href="js.html">JavaScript</a></li>
          <li><a href="db.html">–î–æ–≤—ñ–¥–Ω–∏–∫</a></li>
          <li><a href="code_editor.html">Code Editor</a></li>
        </ul>
      </nav>
    </header>

    <main>
        <h1>–î–æ–≤—ñ–¥–Ω–∏–∫: HTML, CSS & JavaScript</h1>
        <input type="text" id="searchInput" placeholder="üîç –ü–æ—à—É–∫ –∑–∞–ø–∏—Å—ñ–≤..." oninput="searchEntries()">
        <button onclick="openModal()">‚ûï –î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å</button>
        
        <table id="dbTable">
            <thead>
                <tr>
                    <th onclick="sortTable(0)">–†–æ–∑–¥—ñ–ª üîΩ</th>
                    <th onclick="sortTable(1)">–ö–û–î &lt;/>, {}, ... üîΩ</th>
                    <th>–û–ø–∏—Å</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</th>
                    <th>–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É</th>
                    <th id="last">–î—ñ—ó</th>
                </tr>
            </thead>
            <tbody>
                <!-- –î–∞–Ω—ñ –±—É–¥—É—Ç—å –≤—Å—Ç–∞–≤–ª—è—Ç–∏—Å—è —Ç—É—Ç -->
            </tbody>
        </table>
    </main>

    <footer>
      <p>&copy; 2025 .hub{CodeNotes}. –£—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω—ñ.</p>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ -->
    <div id="modal" class="modal">
        <h2 id="modalTitle">–ù–æ–≤–∏–π –∑–∞–ø–∏—Å</h2>

        <input type="hidden" id="entryId">
        
        <label>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: 
            <select id="entryType">
                <option value="HTML">HTML</option>
                <option value="CSS">CSS</option>
                <option value="JavaScript">JavaScript</option>
            </select>
        </label><br>
        
        <label>–¢–µ–≥: <textarea type="text" id="entryName"></textarea></label><br>
        
        <label>–û–ø–∏—Å: <textarea id="entryDescription"></textarea></label><br>

        <label>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: 
            <select id="entryCategory">
                <option value="–û—Å–Ω–æ–≤–Ω—ñ HTML —Ç–µ–≥–∏">–û—Å–Ω–æ–≤–Ω—ñ HTML —Ç–µ–≥–∏</option>
                <option value="–§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è">–§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è</option>
                <option value="–§–æ—Ä–º–∏ —Ç–∞ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ">–§–æ—Ä–º–∏ —Ç–∞ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ</option>
                <option value="–§—Ä–µ–π–º–∏">–§—Ä–µ–π–º–∏</option>
                <option value="–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è">–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è</option>
                <option value="–ê—É–¥—ñ–æ/–í—ñ–¥–µ–æ">–ê—É–¥—ñ–æ/–í—ñ–¥–µ–æ</option>
                <option value="–ü–æ—Å–∏–ª–∞–Ω–Ω—è">–ü–æ—Å–∏–ª–∞–Ω–Ω—è</option>
                <option value="–°–ø–∏—Å–∫–∏">–°–ø–∏—Å–∫–∏</option>
                <option value="–¢–∞–±–ª–∏—Ü—ñ">–¢–∞–±–ª–∏—Ü—ñ</option>
                <option value="–°—Ç–∏–ª—ñ —ñ —Å–µ–º–∞–Ω—Ç–∏–∫–∞">–°—Ç–∏–ª—ñ —ñ —Å–µ–º–∞–Ω—Ç–∏–∫–∞</option>
                <option value="–ú–µ—Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è">–ú–µ—Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</option>
                <option value="–ü—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è">–ü—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è</option>
                <option value="HTML –∞—Ç—Ä–∏–±—É—Ç">HTML –∞—Ç—Ä–∏–±—É—Ç</option>
                <option value="CSS –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å">CSS –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å</option>
                <option value="–§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É">–§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É</option>
                <option value="HTML –µ–ª–µ–º–µ–Ω—Ç–∏ —Ü–∏—Ç—É–≤–∞–Ω–Ω—è">HTML –µ–ª–µ–º–µ–Ω—Ç–∏ —Ü–∏—Ç—É–≤–∞–Ω–Ω—è</option>
                <option value="HTML –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ">HTML –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ</option>  
                <option value="–ö–æ–ª—å–æ—Ä–∏ –≤ HTML">–ö–æ–ª—å–æ—Ä–∏ –≤ HTML</option>                
            </select>
        </label><br>

        <!--<input type="text" id="entryCategory" placeholder="–ö–∞—Ç–µ–≥–æ—Ä—ñ—è">-->

        <textarea id="entryExample" placeholder="–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É..."></textarea>
        
        <button onclick="saveEntry()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
        <button onclick="closeModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </div>
    <div id="modalOverlay" class="modal-overlay" onclick="closeModal()"></div>

    <script src="script.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", loadEntries);

        function loadEntries() {
            fetch('http://localhost:5000/api/get-entries')
                .then(response => response.json())
                .then(data => {
                    renderTable(data);
                })
                .catch(error => console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:', error));
        }

    function escapeHTML(str) {
    return str.replace(/&/g, "&amp;")
              .replace(/</g, "&lt;")
              .replace(/>/g, "&gt;")
              .replace(/"/g, "&quot;")
              .replace(/'/g, "&#39;");
    }
    
    function renderTable(data) {
    const tbody = document.querySelector("#dbTable tbody");
    tbody.innerHTML = "";
    data.forEach(entry => {
        const row = `<tr>
            <td>${entry.type}</td>
            <td><textarea class="textarea" rows="1" readonly>${entry.name}</textarea></td>
            <td>${entry.description}</td>
            <td>${entry.category}</td>
            <td><pre>${entry.example_code}</pre></td>
            <td>
                <button onclick="openModal(${entry.id}, '${entry.type}', '${escapeHTML(entry.name)}', '${escapeHTML(entry.description)}', '${escapeHTML(entry.category)}', '${escapeHTML(entry.example_code)}')">‚úèÔ∏è</button>
                <button onclick="deleteEntry(${entry.id})">üóë</button>
            </td>
        </tr>`;
        tbody.innerHTML += row;
    });
}


        function searchEntries() {
            const query = document.getElementById("searchInput").value.toLowerCase();
            const rows = document.querySelectorAll("#dbTable tbody tr");
            rows.forEach(row => {
                const text = row.innerText.toLowerCase();
                row.style.display = text.includes(query) ? "" : "none";
            });
        }

        function sortTable(columnIndex) {
            const table = document.getElementById("dbTable");
            const rows = Array.from(table.rows).slice(1);
            const sortedRows = rows.sort((a, b) => 
                a.cells[columnIndex].innerText.localeCompare(b.cells[columnIndex].innerText)
            );
            document.querySelector("#dbTable tbody").append(...sortedRows);
        }

        function openModal(id = null, type = 'HTML', name = '', description = '', category = '', example_code = '') {
            document.getElementById("modal").classList.add("show");
            document.getElementById("modalOverlay").classList.add("show");

            document.getElementById("entryId").value = id || '';
            document.getElementById("entryType").value = type;
            document.getElementById("entryName").value = name;
            document.getElementById("entryDescription").value = description;
            document.getElementById("entryCategory").value = category;

            // –ï–∫—Ä–∞–Ω—É—î–º–æ HTML-–∫–æ–¥, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º —ñ–∑ –ª–∞–ø–∫–∞–º–∏
            document.getElementById("entryExample").value = example_code.replace(/"/g, '&quot;').replace(/'/g, '&#39;');

            document.getElementById("modalTitle").innerText = id ? "–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Å" : "–ù–æ–≤–∏–π –∑–∞–ø–∏—Å";
        }

        function closeModal() {
            document.getElementById("modal").classList.remove("show");
            document.getElementById("modalOverlay").classList.remove("show");
        }

        function saveEntry() {
            const id = document.getElementById("entryId").value;
            const type = document.getElementById("entryType").value;
            const name = document.getElementById("entryName").value.trim();
            const description = document.getElementById("entryDescription").value.trim();
            const category = document.getElementById("entryCategory").value.trim();
            const example_code = document.getElementById("entryExample").value.trim();

            console.log("üìù –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –¥–∞–Ω—ñ:", { type, name, description, category, example_code });

    if (!type || !name || !description) {
        alert("‚ùå –í—Å—ñ –ø–æ–ª—è –º–∞—é—Ç—å –±—É—Ç–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ!");
        return;
    }

            const url = id ? `http://localhost:5000/api/edit-entry/${id}` : 'http://localhost:5000/api/add-entry';
            const method = id ? 'PUT' : 'POST';

            fetch(url, {
                method: method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ type, name, description, category, example_code })
            }).then(() => {
                closeModal();
                loadEntries();
            });
        }
        </script>
  </body>
</html>
