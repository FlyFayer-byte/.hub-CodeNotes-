<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–æ–≤—ñ–¥–Ω–∏–∫ HTML & CSS</title>
    <link rel="stylesheet" href="styles.css">
    <style>
/* –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ */
.modal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.8);
    background: rgba(0, 0, 0, 0.9);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 255, 212, 0.8);
    z-index: 1000;
    opacity: 0;
    transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
    width: 90%;
    max-width: 400px;
}

.modal.show {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
    display: block;
}

.modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
}

.modal-overlay.show {
    opacity: 1;
    display: block;
}
    </style>
</head>
<body>
    <header>
        <div id="logo">.hub{CodeNotes}</div>
        <nav>
            <ul>
                <li><a href="index.html">–ì–æ–ª–æ–≤–Ω–∞</a></li>
                <li><a href="html.html">HTML</a></li>
                <li><a href="css.html">CSS</a></li>
                <li><a href="js.html">JavaScript</a></li>
                <li><a href="db.html">–î–æ–≤—ñ–¥–Ω–∏–∫</a></li>
                <li><a href="code_editor.html">Code Editor</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <h1>–î–æ–≤—ñ–¥–Ω–∏–∫ HTML CSS & JavaScript</h1>
        <input type="text" id="searchInput" placeholder="üîç –ü–æ—à—É–∫ –∑–∞–ø–∏—Å—ñ–≤..." oninput="searchEntries()">
        <button onclick="openModal()">‚ûï –î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å</button>
        
        <table id="dbTable">
            <thead>
                <tr>
                    <th onclick="sortTable(0)">–ï–ª–µ–º–µ–Ω—Ç–∏ üîΩ</th>
                    <th onclick="sortTable(1)">–ù–∞–∑–≤–∞ üîΩ</th>
                    <th>–û–ø–∏—Å</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</th>
                    <th>–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É</th>
                    <th id="last">–î—ñ—ó</th>
                </tr>
            </thead>
            <tbody>
                <!-- –î–∞–Ω—ñ –±—É–¥—É—Ç—å –≤—Å—Ç–∞–≤–ª—è—Ç–∏—Å—è —Ç—É—Ç -->
            </tbody>
        </table>
    </main>

    <footer>
        <p>&copy; 2025 .hub{CodeNotes}. –£—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω—ñ.</p>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ -->
    <div id="modal" class="modal">
        <h2 id="modalTitle">–ù–æ–≤–∏–π –∑–∞–ø–∏—Å</h2>

        <input type="hidden" id="entryId">
        
        <label>–¢–∏–ø: 
            <select id="entryType">
                <option value="HTML">HTML</option>
                <option value="CSS">CSS</option>
                <option value="JavaScript">JavaScript</option>
            </select>
        </label>
        
        <label>–ù–∞–∑–≤–∞: <input type="text" id="entryName"></label>
        
        <label>–û–ø–∏—Å: <textarea id="entryDescription"></textarea></label>

        <input type="text" id="entryCategory" placeholder="–ö–∞—Ç–µ–≥–æ—Ä—ñ—è">

        <textarea id="entryExample" placeholder="–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É..."></textarea>
        
        <button onclick="saveEntry()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
        <button onclick="closeModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </div>
    <div id="modalOverlay" class="modal-overlay" onclick="closeModal()"></div>

    <script src="script.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", loadEntries);

        function loadEntries() {
            fetch('http://localhost:5000/api/get-entries')
                .then(response => response.json())
                .then(data => {
                    renderTable(data);
                })
                .catch(error => console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:', error));
        }

    function renderTable(data) {
    const tbody = document.querySelector("#dbTable tbody");
    tbody.innerHTML = "";
    data.forEach(entry => {
        const row = `<tr>
            <td>${entry.type}</td>
            <td>${entry.name}</td>
            <td>${entry.description}</td>
            <td>${entry.category}</td>
            <td><pre>${entry.example_code}</pre></td>
            <td>
                <button onclick="openModal(${entry.id}, '${entry.type}', '${entry.name}', '${entry.description}', '${entry.category}', '${entry.example_code}')">‚úèÔ∏è</button>
                <button onclick="deleteEntry(${entry.id})">üóë</button>
            </td>
        </tr>`;
        tbody.innerHTML += row;
    });
}


        function searchEntries() {
            const query = document.getElementById("searchInput").value.toLowerCase();
            const rows = document.querySelectorAll("#dbTable tbody tr");
            rows.forEach(row => {
                const text = row.innerText.toLowerCase();
                row.style.display = text.includes(query) ? "" : "none";
            });
        }

        function sortTable(columnIndex) {
            const table = document.getElementById("dbTable");
            const rows = Array.from(table.rows).slice(1);
            const sortedRows = rows.sort((a, b) => 
                a.cells[columnIndex].innerText.localeCompare(b.cells[columnIndex].innerText)
            );
            document.querySelector("#dbTable tbody").append(...sortedRows);
        }

        function openModal(id = null, type = 'HTML', name = '', description = '', category = '', example_code = '') {
            document.getElementById("modal").classList.add("show");
            document.getElementById("modalOverlay").classList.add("show");
            document.getElementById("entryId").value = id || '';
            document.getElementById("entryType").value = type;
            document.getElementById("entryName").value = name;
            document.getElementById("entryDescription").value = description;
            document.getElementById("entryCategory").value = category;
            document.getElementById("entryExample").value = example_code;
            document.getElementById("modalTitle").innerText = id ? "–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Å" : "–ù–æ–≤–∏–π –∑–∞–ø–∏—Å";
        }

        function closeModal() {
            document.getElementById("modal").classList.remove("show");
            document.getElementById("modalOverlay").classList.remove("show");
        }

        function saveEntry() {
            const id = document.getElementById("entryId").value;
            const type = document.getElementById("entryType").value;
            const name = document.getElementById("entryName").value.trim();
            const description = document.getElementById("entryDescription").value.trim();
            const category = document.getElementById("entryCategory").value.trim();
            const example_code = document.getElementById("entryExample").value.trim();

            console.log("üìù –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –¥–∞–Ω—ñ:", { type, name, description, category, example_code });

    if (!type || !name || !description) {
        alert("‚ùå –í—Å—ñ –ø–æ–ª—è –º–∞—é—Ç—å –±—É—Ç–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ!");
        return;
    }

            const url = id ? `http://localhost:5000/api/edit-entry/${id}` : 'http://localhost:5000/api/add-entry';
            const method = id ? 'PUT' : 'POST';

            fetch(url, {
                method: method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ type, name, description, category, example_code })
            }).then(() => {
                closeModal();
                loadEntries();
            });
        }
    </script>
</body>
</html>
